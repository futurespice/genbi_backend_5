# üéØ Genbi Admin Panel API

–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å –¥–ª—è —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ Genbi –Ω–∞ FastAPI —Å PostgreSQL.

## üìã –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### ‚úÖ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úîÔ∏è –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ `extra_forbidden` –≤ Pydantic (–¥–æ–±–∞–≤–ª–µ–Ω `extra = "ignore"`)
- ‚úîÔ∏è –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã enum values (—Ç–µ–ø–µ—Ä—å lowercase: "admin", "company", "client")
- ‚úîÔ∏è –£–±—Ä–∞–Ω–æ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –ø–æ–ª–µ `created_at` –∏–∑ `UserResponse`
- ‚úîÔ∏è –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `CONNECTION_STRING` –¥–ª—è –æ–±–ª–∞—á–Ω—ã—Ö –ë–î (Neon)
- ‚úîÔ∏è –ù–∞—Å—Ç—Ä–æ–µ–Ω CORS –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
- ‚úîÔ∏è –î–æ–±–∞–≤–ª–µ–Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### üöÄ –ù–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- ‚úîÔ∏è **Refresh —Ç–æ–∫–µ–Ω—ã** - –ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è access/refresh —Ç–æ–∫–µ–Ω–æ–≤
- ‚úîÔ∏è **–ü–∞–≥–∏–Ω–∞—Ü–∏—è** - –≤—Å–µ —Å–ø–∏—Å–∫–∏ —Ç–µ–ø–µ—Ä—å —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- ‚úîÔ∏è **–≠–Ω–¥–ø–æ–∏–Ω—Ç `/users`** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –¥–ª—è –∞–¥–º–∏–Ω–∞
- ‚úîÔ∏è **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π** - —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è: 8+ —Å–∏–º–≤–æ–ª–æ–≤, –∑–∞–≥–ª–∞–≤–Ω–∞—è –±—É–∫–≤–∞, —Ü–∏—Ñ—Ä–∞
- ‚úîÔ∏è **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞**:
  - –ù–µ–ª—å–∑—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—à–µ–¥—à–∏–µ –¥–∞—Ç—ã
  - –ù–µ–ª—å–∑—è –æ—Å—Ç–∞–≤–∏—Ç—å 2+ –æ—Ç–∑—ã–≤–∞ –Ω–∞ –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Å—á—ë—Ç —Ä–µ–π—Ç–∏–Ω–≥–∞ —Ç—É—Ä–æ–≤
  - –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π

### üìä –ù–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### Auth
- `POST /api/v1/auth/register` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `POST /api/v1/auth/login` - –ª–æ–≥–∏–Ω (OAuth2)
- `POST /api/v1/auth/login/json` - –ª–æ–≥–∏–Ω (JSON)
- `POST /api/v1/auth/refresh` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
- `GET /api/v1/auth/me` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ

#### Users (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω)
- `GET /api/v1/users` - —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π)
- `GET /api/v1/users/{id}` - –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `PATCH /api/v1/users/{id}` - –æ–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `DELETE /api/v1/users/{id}` - —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### Companies
- `GET /api/v1/companies/my` - –º–æ—è –∫–æ–º–ø–∞–Ω–∏—è
- `PATCH /api/v1/companies/{id}` - –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–∞–Ω–∏—é
- `DELETE /api/v1/companies/{id}` - —É–¥–∞–ª–∏—Ç—å –∫–æ–º–ø–∞–Ω–∏—é

#### Tours
- `GET /api/v1/tours/my` - —Ç—É—Ä—ã –º–æ–µ–π –∫–æ–º–ø–∞–Ω–∏–∏
- `PATCH /api/v1/tours/{id}` - –æ–±–Ω–æ–≤–∏—Ç—å —Ç—É—Ä
- `DELETE /api/v1/tours/{id}` - —É–¥–∞–ª–∏—Ç—å —Ç—É—Ä

#### Bookings
- `GET /api/v1/bookings/{id}` - –ø–æ–ª—É—á–∏—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- `DELETE /api/v1/bookings/{id}` - —É–¥–∞–ª–∏—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω)

#### Reviews
- `GET /api/v1/reviews/{id}` - –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–∑—ã–≤
- `DELETE /api/v1/reviews/{id}` - —É–¥–∞–ª–∏—Ç—å –æ—Ç–∑—ã–≤

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
```bash
git clone <your-repo>
cd genbi_backend
```

### 2. –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```bash
python3 -m venv venv
source venv/bin/activate  # Linux/Mac
# –∏–ª–∏
venv\Scripts\activate  # Windows
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
pip install -r requirements.txt
```

### 4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env —Ñ–∞–π–ª
```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª
```

**–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π PostgreSQL:**
```env
POSTGRES_USER=genbi_user
POSTGRES_PASSWORD=genbi_pass
POSTGRES_SERVER=localhost
POSTGRES_PORT=5433
POSTGRES_DB=genbi_db
SECRET_KEY=your-secret-key-here
```

**–î–ª—è –æ–±–ª–∞—á–Ω–æ–π –ë–î (Neon):**
```env
CONNECTION_STRING=postgresql://user:pass@host/db?sslmode=require
SECRET_KEY=your-secret-key-here
```

### 5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ PostgreSQL (–µ—Å–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ)
```bash
docker-compose up -d
```

### 6. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
```bash
alembic upgrade head
```

### 7. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
```bash
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8000

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (Swagger): http://localhost:8000/api/v1/docs

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SECRET_KEY
```bash
openssl rand -hex 32
```

–ó–∞–º–µ–Ω–∏—Ç–µ `SECRET_KEY` –≤ `.env` –Ω–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á.

### ‚ö†Ô∏è –í–ê–ñ–ù–û!
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` –≤ Git!
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.env.example` –∫–∞–∫ —à–∞–±–ª–æ–Ω
- –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —É–∫–∞–∂–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–æ–º–µ–Ω—ã –≤ CORS

## üë• –†–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞

| –†–æ–ª—å | –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ |
|------|-------------|
| **ADMIN** | –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º |
| **COMPANY** | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤–æ–µ–π –∫–æ–º–ø–∞–Ω–∏–µ–π –∏ —Ç—É—Ä–∞–º–∏ |
| **CLIENT** | –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—É—Ä–æ–≤, –æ—Ç–∑—ã–≤—ã |

## üìù –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
```bash
curl -X POST "http://localhost:8000/api/v1/auth/register" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "SecurePass123",
    "full_name": "John Doe",
    "role": "client"
  }'
```

### –õ–æ–≥–∏–Ω
```bash
curl -X POST "http://localhost:8000/api/v1/auth/login" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=user@example.com&password=SecurePass123"
```

### –ü–æ–ª—É—á–∏—Ç—å —Ç—É—Ä—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
```bash
curl "http://localhost:8000/api/v1/tours?page=1&per_page=20&location=–ú–æ—Å–∫–≤–∞&min_price=1000&sort_by=rating"
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
pytest
pytest --cov=app tests/
```

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
genbi_backend/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deps.py              # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ v1/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ api.py           # –ì–ª–∞–≤–Ω—ã–π —Ä–æ—É—Ç–µ—Ä
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ endpoints/       # –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ auth.py
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ users.py
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ companies.py
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ tours.py
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ bookings.py
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ reviews.py
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ security.py          # –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (JWT, —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ)
‚îÇ   ‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py              # –ò–º–ø–æ—Ä—Ç –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base_class.py        # Base –∫–ª–∞—Å—Å SQLAlchemy
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ session.py           # –°–µ—Å—Å–∏—è –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ models/                  # –ú–æ–¥–µ–ª–∏ –ë–î
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ company.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tour.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ booking.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ review.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ enums.py
‚îÇ   ‚îú‚îÄ‚îÄ schemas/                 # Pydantic —Å—Ö–µ–º—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ company.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tour.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ booking.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ review.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ token.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pagination.py
‚îÇ   ‚îî‚îÄ‚îÄ main.py                  # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ alembic/                     # –ú–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ .env.example
‚îî‚îÄ‚îÄ README.md
```

## üöÄ –î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã (pytest)
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD
- [ ] –î–æ–±–∞–≤–∏—Ç—å rate limiting
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (Redis)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Docker production
- [ ] –î–æ–±–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (email, SMS)

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ï—Å–ª–∏ –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã - –ø–∏—à–∏—Ç–µ!

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
